<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Fit Finesse - Bet on Yourself</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff4500">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Archivo:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Stripe -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <style>
        :root {
            --electric-orange: #ff4500;
            --neon-green: #00ff41;
            --deep-black: #0a0a0a;
            --dark-gray: #1a1a1a;
            --mid-gray: #2a2a2a;
            --light-gray: #666;
            --white: #ffffff;
            --success: #00ff41;
            --danger: #ff1744;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Archivo', sans-serif;
            background: var(--deep-black);
            color: var(--white);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 69, 0, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 255, 65, 0.1) 0%, transparent 50%),
                var(--deep-black);
            animation: bgShift 20s ease infinite;
        }

        @keyframes bgShift {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, 20px); }
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 0;
            min-height: 100vh;
        }

        h1, h2, h3 {
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 2px;
        }

        /* Auth Screen */
        .auth-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            text-align: center;
        }

        .logo {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 4rem;
            background: linear-gradient(135deg, var(--electric-orange), var(--neon-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            animation: glow 3s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(255, 69, 0, 0.5)); }
            50% { filter: drop-shadow(0 0 40px rgba(255, 69, 0, 0.8)); }
        }

        .tagline {
            font-size: 1.2rem;
            color: var(--light-gray);
            margin-bottom: 3rem;
            font-weight: 500;
            letter-spacing: 1px;
        }

        .auth-form {
            width: 100%;
            max-width: 320px;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        input {
            width: 100%;
            padding: 1rem;
            background: var(--dark-gray);
            border: 2px solid var(--mid-gray);
            border-radius: 8px;
            color: var(--white);
            font-size: 1rem;
            font-family: 'Archivo', sans-serif;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: var(--electric-orange);
            box-shadow: 0 0 0 4px rgba(255, 69, 0, 0.1);
        }

        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--electric-orange), #ff6b35);
            color: var(--white);
            box-shadow: 0 4px 20px rgba(255, 69, 0, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(255, 69, 0, 0.5);
        }

        .btn-secondary {
            background: transparent;
            color: var(--white);
            border: 2px solid var(--mid-gray);
            margin-top: 1rem;
        }

        .btn-secondary:hover {
            border-color: var(--electric-orange);
            background: rgba(255, 69, 0, 0.1);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            text-align: center;
        }

        .link-btn {
            background: none;
            border: none;
            color: var(--electric-orange);
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        /* Navigation */
        .nav {
            display: flex;
            justify-content: space-around;
            background: var(--dark-gray);
            padding: 1rem 0;
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 480px;
            border-top: 1px solid var(--mid-gray);
            z-index: 100;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 0.5rem;
            color: var(--light-gray);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
        }

        .nav-item.active {
            color: var(--electric-orange);
        }

        /* Header */
        .header {
            padding: 2rem 1.5rem 1rem;
            background: linear-gradient(180deg, var(--dark-gray) 0%, transparent 100%);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        /* Main Content */
        .main-content {
            padding: 1.5rem;
            padding-bottom: 100px;
        }

        /* Pool Card */
        .pool-card {
            background: var(--dark-gray);
            border: 2px solid var(--mid-gray);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .pool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--electric-orange), var(--neon-green));
        }

        .pool-card:hover {
            border-color: var(--electric-orange);
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(255, 69, 0, 0.2);
        }

        .pool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .pool-name {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            letter-spacing: 1px;
        }

        .pool-pot {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--neon-green);
        }

        .pool-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .info-item {
            background: var(--mid-gray);
            padding: 0.75rem;
            border-radius: 8px;
        }

        .info-label {
            font-size: 0.7rem;
            color: var(--light-gray);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
        }

        .info-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            letter-spacing: 1px;
        }

        .pool-members {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .member-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--mid-gray);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        .member-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .member-status.success {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        .member-status.pending {
            background: var(--light-gray);
        }

        .member-status.failed {
            background: var(--danger);
            box-shadow: 0 0 10px var(--danger);
        }

        .checkin-btn {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, var(--neon-green), #00cc33);
            border: none;
            border-radius: 8px;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            letter-spacing: 2px;
            color: var(--deep-black);
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }

        .checkin-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 255, 65, 0.4);
        }

        .checkin-btn:disabled {
            background: var(--mid-gray);
            cursor: not-allowed;
            color: var(--light-gray);
        }

        .checkin-btn.checked-in-today {
            background: var(--mid-gray) !important;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--dark-gray);
            border: 2px solid var(--mid-gray);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--electric-orange), var(--neon-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--light-gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-section {
            background: var(--dark-gray);
            border: 2px solid var(--mid-gray);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-section h3 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        label {
            display: block;
            font-size: 0.8rem;
            color: var(--light-gray);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            margin-top: 1rem;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }

        .modal-content {
            background: var(--dark-gray);
            border: 2px solid var(--electric-orange);
            border-radius: 12px;
            padding: 2rem;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .modal-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .modal h2 {
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .modal p {
            color: var(--light-gray);
            margin-bottom: 2rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--light-gray);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideUp 0.5s ease forwards;
        }

        .hidden {
            display: none !important;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--mid-gray);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--electric-orange), var(--neon-green));
            transition: width 0.3s;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--light-gray);
        }
        /* Hide number input arrows */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

/* Hamburger Button */
.hamburger-btn {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    background: none;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
    padding: 0.5rem;
    z-index: 100;
    line-height: 1;
}

.hamburger-btn:hover {
    opacity: 0.7;
}

/* Menu Overlay */
.menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    z-index: 1000;
    animation: fadeIn 0.2s ease-in;
}

/* Menu Container */
.menu-container {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    width: 320px;
    max-width: 85vw;
    background: var(--card-bg);
    box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
    animation: slideInRight 0.3s ease-out;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
}

/* Menu Header */
.menu-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.menu-close-btn {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    line-height: 1;
}

.menu-close-btn:hover {
    opacity: 0.7;
}

/* Menu Content */
.menu-content {
    flex: 1;
    padding: 1rem;
}

/* Menu Profile */
.menu-profile {
    text-align: center;
    padding: 1.5rem 1rem;
    background: var(--dark-gray);
    border-radius: 12px;
    margin-bottom: 1rem;
}

/* Menu Divider */
.menu-divider {
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
    margin: 1rem 0;
}

/* Menu Items */
.menu-item {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: none;
    border: none;
    color: white;
    font-size: 1rem;
    cursor: pointer;
    border-radius: 8px;
    transition: background 0.2s;
    text-align: left;
}

.menu-item:hover {
    background: var(--dark-gray);
}

.menu-item span:first-child {
    font-size: 1.3rem;
    width: 1.5rem;
    text-align: center;
}

.menu-logout {
    color: var(--electric-orange);
    margin-top: 0.5rem;
}

/* Content Pages */
.content-page {
    min-height: 100vh;
    background: var(--bg-color);
    padding-bottom: 2rem;
}

.content-header {
    background: var(--bg-color);
    padding: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: sticky;
    top: 0;
    z-index: 10;
    backdrop-filter: blur(10px);
}

.back-btn {
    background: none;
    border: none;
    color: var(--neon-green);
    font-size: 1rem;
    cursor: pointer;
    padding: 0.5rem 0;
    margin-bottom: 1rem;
    display: block;
}

.back-btn:hover {
    opacity: 0.7;
}

.content-body {
    padding: 1.5rem;
    max-width: 600px;
    margin: 0 auto;
}

/* How It Works Sections */
.how-it-works-section {
    background: var(--card-bg);
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 1rem;
    position: relative;
    padding-left: 5rem;
}

.step-number {
    position: absolute;
    left: 1.5rem;
    top: 1.5rem;
    width: 2.5rem;
    height: 2.5rem;
    background: var(--neon-green);
    color: var(--bg-color);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bebas Neue';
    font-size: 1.5rem;
}

.how-it-works-section h3 {
    margin-top: 0;
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
}

.how-it-works-section p {
    margin: 0;
    color: var(--light-gray);
    line-height: 1.6;
}

/* FAQ Items */
.faq-item {
    background: var(--card-bg);
    padding: 1.5rem;
    border-radius: 12px;
    margin-bottom: 1rem;
}

.faq-item h3 {
    margin-top: 0;
    margin-bottom: 0.75rem;
    font-size: 1.1rem;
    color: white;
}

.faq-item p {
    margin: 0;
    color: var(--light-gray);
    line-height: 1.6;
    font-weight: 500;
}

/* Animations */
@keyframes slideInRight {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}
        
    </style>
    <!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getAuth, RecaptchaVerifier, signInWithPhoneNumber } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
  
  const firebaseConfig = {
  apiKey: "AIzaSyAuFPy77FQR8WuQwMt-kweYpGAIY4R32dk",
  authDomain: "fit-finesse-79fe7.firebaseapp.com",
  projectId: "fit-finesse-79fe7",
  storageBucket: "fit-finesse-79fe7.firebasestorage.app",
  messagingSenderId: "783525209780",
  appId: "1:783525209780:web:fc13db7c57bef07c5a19e1",
  measurementId: "G-G4SCRF4NV4"
};
  
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  
  // Make auth available globally
  window.firebaseAuth = auth;
  window.RecaptchaVerifier = RecaptchaVerifier;
  window.signInWithPhoneNumber = signInWithPhoneNumber;
</script>
</head>
<body>
    <div class="bg-gradient"></div>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // API Configuration
        const API_URL = 'https://fitfinesse-backend.onrender.com';

        // API Helper
        const api = {
            async request(endpoint, options = {}) {
                const token = localStorage.getItem('token');
                const headers = {
                    'Content-Type': 'application/json',
                    ...(token && { 'Authorization': `Bearer ${token}` })
                };

                const response = await fetch(`${API_URL}${endpoint}`, {
                    ...options,
                    headers: { ...headers, ...options.headers }
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.detail || 'Request failed');
                }

                return response.json();
            },

            async signup(email, name, password, phone) {
    return this.request('/auth/signup', {
        method: 'POST',
        body: JSON.stringify({ email, name, password, phone })
    });
},

            async login(email, password) {
                return this.request('/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ email, password })
                });
            },

            async getMe() {
                return this.request('/auth/me');
            },

            async getPools() {
                return this.request('/pools');
            },

            async createPool(poolData) {
                return this.request('/pools', {
                    method: 'POST',
                    body: JSON.stringify(poolData)
                });
            },

            getHistory: async () => {
                 return api.request('/pools/history');
            },

            async checkIn(poolId, lat, lng) {
                return this.request('/checkins', {
                    method: 'POST',
                    body: JSON.stringify({
                        pool_id: poolId,
                        latitude: lat,
                        longitude: lng
                    })
                });
            },

            async getStats() {
    return this.request('/stats');
},

async acceptPool(poolId) {
    return this.request(`/pools/${poolId}/accept`, {
        method: 'POST'
    });
},

async rejectPool(poolId) {
    return this.request(`/pools/${poolId}/reject`, {
        method: 'POST'
    });
},

async cancelPool(poolId) {
    return this.request(`/pools/${poolId}`, {
        method: 'DELETE'
    });
}
};

        function App() {
            const [currentScreen, setCurrentScreen] = useState('auth');
            const [authMode, setAuthMode] = useState('login');
            const [user, setUser] = useState(null);
            const [pools, setPools] = useState([]);
            const [historyPools, setHistoryPools] = useState([]);
            const [stats, setStats] = useState(null);
            const [activeNav, setActiveNav] = useState('pools');
            const [showModal, setShowModal] = useState(false);
            const [showMenu, setShowMenu] = useState(false);
            const [activeView, setActiveView] = useState('app');
            const [modalContent, setModalContent] = useState({});
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            const [phoneVerificationSent, setPhoneVerificationSent] = useState(false);
const [confirmationResult, setConfirmationResult] = useState(null);
            const [phone, setPhone] = useState('+1 ');

            useEffect(() => {
                const token = localStorage.getItem('token');
                if (token) {
                    loadUser();
                }
            }, []);

            const loadUser = async () => {
                try {
                    const userData = await api.getMe();
                    setUser(userData);
                    setCurrentScreen('main');
                    loadPools();
                    loadStats();
                } catch (err) {
                    localStorage.removeItem('token');
                }
            };

            const loadPools = async () => {
                try {
                    const poolsData = await api.getPools();
                    setPools(poolsData);

                    // Load history too
                    const historyData = await api.getHistory();
                    setHistoryPools(historyData);
                } catch (err) {
                    console.error('Failed to load pools:', err);
                }
            };

            const loadStats = async () => {
                try {
                    const statsData = await api.getStats();
                    setStats(statsData);
                } catch (err) {
                    console.error('Failed to load stats:', err);
                }
            };
const sendVerificationCode = async () => {
    if (!phone || phone === '+1 ') {
        setError('Please enter a phone number');
        return;
    }
    
    const cleanPhone = phone.replace(/\D/g, '');
    
    if (cleanPhone.length < 11) {
        setError('Please enter a complete 10-digit phone number');
        return;
    }
    
    const formattedPhone = '+' + cleanPhone;
    
    setLoading(true);
    setError('');
    
    try {
        // Only create reCAPTCHA if it doesn't exist
        if (!window.recaptchaVerifier) {
            window.recaptchaVerifier = new window.RecaptchaVerifier(window.firebaseAuth, 'recaptcha-container', {
                'size': 'invisible',
                'callback': (response) => {}
            });
        }
        
        const confirmationResult = await window.signInWithPhoneNumber(
            window.firebaseAuth,
            formattedPhone,
            window.recaptchaVerifier
        );
        
        setConfirmationResult(confirmationResult);
        setPhoneVerificationSent(true);
        setLoading(false);
    } catch (err) {
        console.error('Error sending verification code:', err);
        console.error('Phone used:', formattedPhone);
        setError('Failed to send code: ' + err.message);
        setLoading(false);
        
        // On error, clear the verifier so it can be recreated
        if (window.recaptchaVerifier) {
            try {
                window.recaptchaVerifier.clear();
            } catch (e) {}
            window.recaptchaVerifier = null;
        }
    }
};
            const handleAuth = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                const formData = new FormData(e.target);
    const email = formData.get('email');
    const password = formData.get('password');
    const name = formData.get('name');
    const confirmPassword = formData.get('confirmPassword');

    // Check password match for signup
    if (authMode === 'signup' && password !== confirmPassword) {
        setError('Passwords do not match');
        setLoading(false);
        return;
    }
// Password strength validation
    if (password.length < 8) {
        setError('Password must be at least 8 characters');
        setLoading(false);
        return;
    }
    
    if (!/\d/.test(password)) {
        setError('Password must contain at least one number');
        setLoading(false);
        return;
    }
                try {
                    let result;
                    if (authMode === 'signup') {
    // Verify phone code first
    if (!phoneVerificationSent) {
        setError('Please verify your phone number first');
        setLoading(false);
        return;
    }
    
    const verificationCode = formData.get('verificationCode');
    if (!verificationCode) {
        setError('Please enter the verification code');
        setLoading(false);
        return;
    }
    
    try {
        // Verify the SMS code with Firebase
        await confirmationResult.confirm(verificationCode);
        
        // Code verified! Now create account in backend
        const phone = formData.get('phone');
        result = await api.signup(email, name, password, phone);
    } catch (err) {
        setError('Invalid verification code');
        setLoading(false);
        return;
    }
                    } else {
                        result = await api.login(email, password);
                    }

                    localStorage.setItem('token', result.token);
                    setUser(result.user);
                    setCurrentScreen('main');
                    loadPools();
                    loadStats();
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            const handleCheckIn = async (poolId) => {
                try {
                    // Get user's location
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(
                            async (position) => {
                    try {
                        await api.checkIn(
                            poolId,
                            position.coords.latitude,
                            position.coords.longitude
                        );
                        
                        setModalContent({
                            icon: '‚úÖ',
                            title: 'Check-in Successful!',
                            message: 'Your gym visit has been verified.'
                        });
                        setShowModal(true);
                        loadPools();
                        setTimeout(() => setShowModal(false), 2000);
                    } catch (err) {
                        setModalContent({
                            icon: '‚ùå',
                            title: 'Check-in Failed',
                            message: err.message || 'Unable to check in. Try again.'
                        });
                        setShowModal(true);
                        setTimeout(() => setShowModal(false), 3000);
                    }
                },
                            (error) => {
                                setModalContent({
                                    icon: '‚ö†Ô∏è',
                                    title: 'Location Required',
                                    message: 'Please enable location services to check in.'
                                });
                                setShowModal(true);
                                setTimeout(() => setShowModal(false), 3000);
                            }
                        );
                    } else {
                        // Fallback if geolocation not supported
                        await api.checkIn(poolId, null, null);
                        loadPools();
                    }
                } catch (err) {
                    setModalContent({
                        icon: '‚ùå',
                        title: 'Check-in Failed',
                        message: err.message
                    });
                    setShowModal(true);
                    setTimeout(() => setShowModal(false), 2000);
                }
            };

            const handleCreatePool = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                const formData = new FormData(e.target);
                
                try {
                    await api.createPool({
                        name: formData.get('poolName'),
                        weekly_goal: parseInt(formData.get('weeklyGoal')),
                        stake: parseFloat(formData.get('stake')),
                        member_emails: formData.get('members').split(',').map(e => e.trim())
                    });

                    setModalContent({
                        icon: 'üéâ',
                        title: 'Pool Created!',
                        message: 'Your pool is live. Time to get to work!'
                    });
                    setShowModal(true);
                    loadPools();
                    
                    setTimeout(() => {
                        setShowModal(false);
                        setActiveNav('pools');
                    }, 2000);
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            const handleLogout = () => {
                localStorage.removeItem('token');
                setUser(null);
                setPools([]);
                setStats(null);
                setCurrentScreen('auth');
                setAuthMode('login');
                setActiveNav('pools');
                setPhone('+1 '); 
    setPhoneVerificationSent(false); 
    if (window.recaptchaVerifier) { 
        window.recaptchaVerifier.clear();
        window.recaptchaVerifier = null;
    }
            };

            // Auth Screen
            if (currentScreen === 'auth') {
                return (
                    <div className="auth-screen animate-in">
                        <h1 className="logo">FIT FINESSE</h1>
                        <p className="tagline">Bet on Yourself</p>
<form className="auth-form" onSubmit={handleAuth}>
    <div id="recaptcha-container"></div>
    {authMode === 'signup' && (
        <div className="input-group">
            <input type="text" name="name" placeholder="Your Name" required />
        </div>
    )}
    <div className="input-group">
        <input type="email" name="email" placeholder="Email" required />
    </div>
               {authMode === 'signup' && (
    <div className="input-group">
        <div style={{display: 'flex', gap: '0.5rem', alignItems: 'center'}}>
           <input
  type="tel"
  name="phone"
  placeholder="Phone Number"
  value={phone}
  onChange={(e) => {
    let value = e.target.value;
    if (!value.startsWith('+1 ')) {
      value = '+1 ';
    }
    const digits = value.slice(3).replace(/\D/g, '');
    let formatted = '+1 ';
    if (digits.length > 0) {
      formatted += digits.slice(0, 3);
    }
    if (digits.length > 3) {
      formatted += '-' + digits.slice(3, 6);
    }
    if (digits.length > 6) {
      formatted += '-' + digits.slice(6, 10);
    }
    setPhone(formatted);
  }}
  required
  style={{flex: 1, minWidth: '200px', height: '50px', padding: '15px'}}
/>
            <button 
                type="button" 
                className="btn btn-secondary"
                onClick={sendVerificationCode}
                disabled={phoneVerificationSent || loading}
                style={{whiteSpace: 'nowrap', width: '140px', padding: '15px', height: '50px', display: 'flex', alignItems: 'center', justifyContent: 'center', lineHeight: 'normal', border: '1px solid #333', borderRadius: '8px', boxSizing: 'border-box', marginTop: '-1.75px'}}
            >
                {phoneVerificationSent ? '‚úì Code Sent' : 'Send Code'}
            </button>
        </div>
        <small style={{color: 'var(--light-gray)', fontSize: '0.85rem', marginTop: '0.25rem'}}>
            Include country code (e.g., +1 for US)
        </small>
    </div>
)}
                        {authMode === 'signup' && phoneVerificationSent && (
    <div className="input-group">
        <input 
            type="text" 
            name="verificationCode" 
            placeholder="Enter 6-digit code" 
            maxLength="6"
            required 
        />
    </div>
)}
    <div className="input-group">
        <input type="password" name="password" placeholder="Password" required />
    </div>
    {authMode === 'signup' && (
        <div className="input-group">
            <input type="password" name="confirmPassword" placeholder="Confirm Password" required />
        </div>
    )}
    {authMode === 'signup' && (
    <div className="input-group">
        <label style={{
            display: 'flex',
            alignItems: 'flex-start',
            gap: '0.5rem',
            fontSize: '0.85rem',
            color: 'var(--light-gray)',
            cursor: 'pointer',
            textAlign: 'left',
            fontWeight: 'normal',
            textTransform: 'none',
            letterSpacing: 'normal',
            marginBottom: '0'
        }}>
            <input 
                type="checkbox" 
                name="termsAccepted" 
                required
                style={{
                    marginTop: '0.25rem',
                    cursor: 'pointer',
                    width: '16px',
                    height: '16px',
                    flexShrink: 0
                }}
            />
            <span>
                I am 18 years or older and agree to the{' '}
                <a 
                    href="terms.html" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    style={{color: 'var(--electric-orange)', textDecoration: 'underline'}}
                >
                    Terms & Conditions
                </a>
            </span>
        </label>
    </div>
)}
    {error && <div className="error">{error}</div>}
    <button type="submit" className="btn btn-primary" disabled={loading}>
        {loading ? 'Loading...' : (authMode === 'login' ? 'Login' : 'Sign Up')}
    </button>
    <button 
    type="button" 
    className="link-btn"
    onClick={(e) => {
        setAuthMode(authMode === 'login' ? 'signup' : 'login');
        setError('');
        setPhone('+1 '); // Reset phone to default
    setPhoneVerificationSent(false); // Reset verification state
    if (window.recaptchaVerifier) {
        window.recaptchaVerifier.clear();
        window.recaptchaVerifier = null;
        // Clear the form
        e.target.closest('form').reset();
         }
    }}>
        {authMode === 'login' ? 'Need an account? Sign up' : 'Already have an account? Login'}
    </button>
    </form>
                    </div>
                );
            }
            // Main App
            return (
                <>
                    {activeView === 'app' ? (
                        <div className="container">
                            <div className="header">
                        <h1>FIT FINESSE</h1>
                        <p style={{fontSize: '1.1rem'}}>Consistency wins, {user?.name}.</p>
                        <button 
                            className="hamburger-btn"
                            onClick={() => setShowMenu(true)}
                            aria-label="Open menu"
                        >
                            ‚ò∞
                        </button>
                    </div>

                    <div className="main-content">
                        {activeNav === 'pools' && (
    <>
        {pools.filter(p => p.your_status === 'pending').length > 0 && (
            <div className="form-section animate-in" style={{marginBottom: '2rem'}}>
                <h3 style={{marginBottom: '1rem'}}>Pending Invitations</h3>
                {pools.filter(p => p.your_status === 'pending').map(pool => (
                    <div key={pool.id} style={{
                        background: 'var(--mid-gray)',
                        padding: '1rem',
                        borderRadius: '8px',
                        marginBottom: '1rem',
                        border: '2px solid var(--electric-orange)'
                    }}>
                        <div style={{marginBottom: '1rem'}}>
    <div style={{fontFamily: 'Bebas Neue', fontSize: '1.3rem'}}>{pool.name}</div>
    <div style={{color: 'var(--light-gray)', fontSize: '0.85rem', marginBottom: '0.25rem'}}>
        Invited by: {pool.creator_name}
    </div>
    <div style={{color: 'var(--light-gray)', fontSize: '0.9rem'}}>
        ${pool.stake} stake ‚Ä¢ {pool.weekly_goal} days/week
    </div>
</div>
                        
                        {pools.filter(p => p.your_status === 'active').length >= 5 && (
    <div style={{
        background: 'rgba(255, 107, 53, 0.2)',
        padding: '0.75rem',
        borderRadius: '6px',
        marginBottom: '0.75rem',
        fontSize: '0.85rem',
        color: 'var(--electric-orange)',
        border: '1px solid var(--electric-orange)',
        textAlign: 'center'
    }}>
        ‚ö†Ô∏è  You have 5 active pools.
    </div>
)}

<div style={{display: 'flex', gap: '0.5rem'}}>
    <button 
        className="btn btn-primary"
        onClick={async () => {
            try {
                await api.acceptPool(pool.id);
                setModalContent({
                    icon: '‚úÖ',
                    title: 'Invitation Accepted!',
                    message: 'You\'re in! Time to hit the gym.'
                });
                setShowModal(true);
                loadPools();
                setTimeout(() => setShowModal(false), 2000);
            } catch (err) {
                setError(err.message);
            }
        }}
        disabled={pools.filter(p => p.your_status === 'active').length >= 5}
        style={{
            flex: 1,
            opacity: pools.filter(p => p.your_status === 'active').length >= 5 ? 0.5 : 1,
            cursor: pools.filter(p => p.your_status === 'active').length >= 5 ? 'not-allowed' : 'pointer'
        }}
    >
        Accept
    </button>
    <button 
        className="btn btn-secondary"
        onClick={async () => {
            try {
                await api.rejectPool(pool.id);
                setModalContent({
                    icon: 'üëã',
                    title: 'Invitation Declined',
                    message: 'Pool invitation removed.'
                });
                setShowModal(true);
                loadPools();
                setTimeout(() => setShowModal(false), 2000);
            } catch (err) {
                setError(err.message);
            }
        }}
        style={{flex: 1}}
    >
        Decline
    </button>
</div>
                    </div>
                ))}
            </div>
        )}
        
        {pools.filter(p => p.your_status === 'active').length === 0 ? (
            <div className="empty-state">
                <div className="empty-state-icon" style={{fontSize: '6rem', fontFamily: 'Bebas Neue', color: 'var(--electric-orange)'}}>START</div>
                <h2>No Active Pools</h2>
                <p>Create your first pool and start winning!</p>
            </div>
        ) : (
            pools.filter(p => p.your_status === 'active').map(pool => (
                <div key={pool.id} className="pool-card animate-in">
                                            <div className="pool-header">
    <div>
        <div className="pool-name">{pool.name}</div>
        <div style={{fontSize: '0.75rem', color: 'var(--light-gray)', marginTop: '0.25rem'}}>
            {(() => {
    // Parse dates without timezone conversion
    const [startYear, startMonth, startDay] = pool.week_start.split('-').map(Number);
    const [endYear, endMonth, endDay] = pool.week_end.split('-').map(Number);
    
    const start = new Date(startYear, startMonth - 1, startDay);
    const end = new Date(endYear, endMonth - 1, endDay);
    
    const monthName = start.toLocaleDateString('en-US', {month: 'short'});
    return `Week of ${monthName} ${start.getDate()}-${end.getDate()}`;
})()}
        </div>
    </div>
    <div className="pool-pot">${pool.pot}</div>
</div>
                                            
                                            <div className="pool-info">
                                                <div className="info-item">
                                                    <div className="info-label">Your Progress</div>
                                                    <div className="info-value">{pool.your_checkins}/{pool.weekly_goal}</div>
                                                </div>
                                                <div className="info-item">
                                                    <div className="info-label">Stake</div>
                                                    <div className="info-value">${pool.stake}</div>
                                                </div>
                                            </div>

                                            <div className="progress-bar">
                                                <div className="progress-fill" style={{width: `${(pool.your_checkins / pool.weekly_goal) * 100}%`}}></div>
                                            </div>

                                            <div style={{marginTop: '1rem'}}>
                                                <div className="info-label" style={{marginBottom: '0.5rem'}}>Members</div>
                                                <div className="pool-members">
                                                    {pool.members.map(member => (
                                                        <div key={member} className="member-badge">
                                                            <div className={`member-status ${
                                                                (pool.member_status[member] || 0) >= pool.weekly_goal ? 'success' : 
                                                                (pool.member_status[member] || 0) > 0 ? 'pending' : 'failed'
                                                            }`}></div>
                                                            {member} ({pool.member_status[member] || 0})
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>

                                            <button 
    className={`checkin-btn ${pool.checked_in_today && pool.your_checkins < pool.weekly_goal ? 'checked-in-today' : ''}`}
    onClick={() => handleCheckIn(pool.id)}
    disabled={pool.your_checkins >= pool.weekly_goal || pool.checked_in_today}
    style={{
        cursor: pool.checked_in_today || pool.your_checkins >= pool.weekly_goal 
            ? 'not-allowed' 
            : 'pointer'
    }}
>
    {pool.your_checkins >= pool.weekly_goal 
        ? 'Goal Complete! üéâ' 
        : pool.checked_in_today 
        ? '‚úì Checked In Today' 
        : 'Check In Now'}
</button>

{pool.creator_id === user?.id && pool.members.length < 2 && (
    <button 
        className="btn btn-secondary"
        onClick={async () => {
    try {
        await api.cancelPool(pool.id);
        setModalContent({
            icon: 'üóëÔ∏è',
            title: 'Pool Cancelled',
            message: 'Pool has been deleted.'
        });
        setShowModal(true);
        loadPools();
        setTimeout(() => setShowModal(false), 2000);
    } catch (err) {
        setModalContent({
            icon: '‚ùå',
            title: 'Cannot Cancel',
            message: err.message || 'Unable to cancel pool'
        });
        setShowModal(true);
        setTimeout(() => setShowModal(false), 3000);
    }
}}
        style={{marginTop: '1rem'}}
    >
        Cancel Pool
    </button>
)}

</div>
                                    ))
                                )}
                            </>
                        )}

                        {activeNav === 'create' && (
    <form className="form-section animate-in" onSubmit={handleCreatePool}>
        <h3>Create New Pool</h3>
        
        <div style={{
    background: 'var(--mid-gray)', 
    padding: '1rem', 
    borderRadius: '8px', 
    marginBottom: '1.5rem',
    color: 'var(--light-gray)',
    fontSize: '0.9rem'
}}>
    <div>‚ìò Pools start next Monday and run for one week</div>
    <div style={{
    marginTop: '0.75rem', 
    paddingTop: '0.75rem', 
    borderTop: '1px solid rgba(255,255,255,0.1)',
    display: 'flex',
    alignItems: 'center',
    gap: '0.25rem'
}}>
    <span style={{fontWeight: '600'}}>Active pools:</span>
    <span style={{
            fontFamily: 'Bebas Neue',
            fontSize: '1.2rem',
            color: pools.filter(p => p.your_status === 'active').length >= 5 
                ? 'var(--electric-orange)' 
                : 'var(--neon-green)'
        }}>
        {pools.filter(p => p.your_status === 'active').length}/5
    </span>
</div>
</div>
                                
                                <label>Pool Name</label>
                                <input type="text" name="poolName" placeholder="e.g., Morning Grind" required />

                                <label>Weekly Gym Goal</label>
                                <input type="number" name="weeklyGoal" min="1" max="5" placeholder="3 Days" required />

                                <label>Your Stake ($)</label>
                <input 
                    type="number"
                    name="stake"
                    min="5"
                    max="100"
                    step="1"
                    placeholder="20"
                    required
                    onChange={(e) => {
                                        const val = parseFloat(e.target.value);
                                        if (val >= 5 && val <= 100) {
                                            e.target.style.borderColor = '#00ff41';
                                            e.target.style.color = '#00ff41';
                                            e.target.style.boxShadow = '0 0 10px rgba(0, 255, 65, 0.5)';
                                        } else {
                                            e.target.style.borderColor = '#2a2a2a';
                                            e.target.style.color = '#ffffff';
                                            e.target.style.boxShadow = 'none';
                                        }
                                    }}
                                />

                                <label>Invite Friends (comma separated emails)</label>
                                <input type="text" name="members" placeholder="friend@email.com, buddy@email.com" required />

                                {error && <div className="error">{error}</div>}

                                <button type="submit" className="btn btn-primary" style={{marginTop: '1.5rem'}} disabled={loading}>
                                    {loading ? 'Creating...' : 'Create Pool'}
                                </button>
                            </form>
                        )}

                        {activeNav === 'stats' && stats && (
                            <>
                                <div className="stats-grid animate-in">
                                    <div className="stat-card">
                                        <div className="stat-value">${Math.max(0, stats.total_winnings)}</div>
                                        <div className="stat-label">Total Winnings</div>
                                    </div>
                                    <div className="stat-card">
                                        <div className="stat-value">{stats.total_pools}</div>
                                        <div className="stat-label">Pools Joined</div>
                                    </div>
                                    <div className="stat-card">
                                        <div className="stat-value">{stats.win_rate}%</div>
                                        <div className="stat-label">Win Rate</div>
                                    </div>
                                    <div className="stat-card">
                                        <div className="stat-value">{stats.current_streak}</div>
                                        <div className="stat-label">Week Streak</div>
                                    </div>
                                </div>

                                <div className="pool-card animate-in">
                                    <h3 style={{marginBottom: '1rem'}}>Account</h3>
                                    <button className="btn btn-secondary" onClick={handleLogout}>
                                        Logout
                                    </button>
                                </div>
                            </>
                        )}


            {activeNav === 'history' && (
                <div className="history-container">
                    <h2 style={{fontFamily: 'Bebas Neue', fontSize: '2rem', marginBottom: '1.5rem'}}>
                        POOL HISTORY
                    </h2>
                    
                    {historyPools.length === 0 ? (
                        <div style={{
                            textAlign: 'center',
                            padding: '3rem 1rem',
                            color: 'var(--light-gray)'
                        }}>
                            <div style={{fontSize: '4rem', marginBottom: '1rem'}}>üèÜ</div>
                            <h3 style={{fontFamily: 'Bebas Neue', fontSize: '1.5rem', marginBottom: '0.5rem'}}>
                                NO HISTORY YET
                            </h3>
                            <p>Complete your first pool to see your wins and losses here</p>
                        </div>
                    ) : (
                        <div>
                            {historyPools.map(pool => (
                                <div 
                                    key={pool.id} 
                                    className="pool-card"
                                    style={{
                                        border: pool.outcome === 'won' 
                                            ? '2px solid var(--neon-green)' 
                                            : pool.outcome === 'lost'
                                            ? '2px solid var(--electric-orange)'
                                            : '2px solid var(--mid-gray)',
                                        opacity: 0.9
                                    }}
                                >
                                    <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '1rem'}}>
                                        <div>
                                            <div style={{fontFamily: 'Bebas Neue', fontSize: '1.5rem'}}>
                                                {pool.outcome === 'won' ? 'üèÜ ' : ''}{pool.name}
                                            </div>
                                            <div style={{color: 'var(--light-gray)', fontSize: '0.85rem'}}>
                                                Week of {(() => {
    const [startYear, startMonth, startDay] = pool.week_start.split('-').map(Number);
    const [endYear, endMonth, endDay] = pool.week_end.split('-').map(Number);
    
    const start = new Date(startYear, startMonth - 1, startDay);
    const end = new Date(endYear, endMonth - 1, endDay);
    
    const startMonthName = start.toLocaleDateString('en-US', {month: 'short'});
    const endMonthName = end.toLocaleDateString('en-US', {month: 'short'});
    
    // If same month, show: "Jan 26-31"
    // If different months, show: "Jan 26 - Feb 1"
    if (startMonth === endMonth) {
        return `${startMonthName} ${start.getDate()}-${end.getDate()}`;
    } else {
        return `${startMonthName} ${start.getDate()} - ${endMonthName} ${end.getDate()}`;
    }
})()}
                                            </div>
                                        </div>
                                        <div style={{
                                            fontFamily: 'Bebas Neue',
                                            fontSize: '1.8rem',
                                            color: pool.payout > 0 
                                                ? 'var(--neon-green)' 
                                                : pool.payout < 0 
                                                ? 'var(--electric-orange)'
                                                : 'var(--light-gray)'
                                        }}>
                                            {pool.payout > 0 ? '+' : ''}{pool.payout === 0 ? '$0' : `$${pool.payout.toFixed(2)}`}
                                        </div>
                                    </div>
                                    
                                    <div style={{
                                        background: 'var(--dark-gray)',
                                        padding: '1rem',
                                        borderRadius: '8px',
                                        marginBottom: '1rem'
                                    }}>
                                        <div style={{marginBottom: '0.5rem'}}>
                                            <span style={{color: 'var(--light-gray)'}}>Your Result: </span>
                                            <span style={{
                                                fontWeight: '600',
                                                color: pool.outcome === 'won' 
                                                    ? 'var(--neon-green)' 
                                                    : pool.outcome === 'lost'
                                                    ? 'var(--electric-orange)'
                                                    : 'var(--light-gray)'
                                            }}>
                                                {pool.outcome === 'won' ? 'WON' : pool.outcome === 'lost' ? 'LOST' : 'TIED'}
                                            </span>
                                        </div>
                                        <div style={{color: 'var(--light-gray)', fontSize: '0.9rem'}}>
                                            Goal: {pool.your_checkins}/{pool.weekly_goal} days {pool.your_checkins >= pool.weekly_goal ? '‚úÖ' : '‚ùå'}
                                        </div>
                                    </div>
                                    
                                    <div style={{
                                        display: 'flex',
                                        justifyContent: 'space-between',
                                        color: 'var(--light-gray)',
                                        fontSize: '0.85rem'
                                    }}>
                                        <div>Pot: ${pool.total_pot}</div>
                                        <div>{pool.winners} {pool.winners === 1 ? 'winner' : 'winners'}, {pool.losers} {pool.losers === 1 ? 'loser' : 'losers'}</div>
                                    </div>
                                    
                                    <div style={{
                                        marginTop: '0.5rem',
                                        color: 'var(--light-gray)',
                                        fontSize: '0.85rem'
                                    }}>
                                        Members: {pool.members.join(', ')}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            )}
                    </div>

                    <div className="nav">
                        <div 
                            className={`nav-item ${activeNav === 'pools' ? 'active' : ''}`}
                            onClick={() => setActiveNav('pools')}
                        >
                            Pools
                        </div>
                        <div 
                            className={`nav-item ${activeNav === 'create' ? 'active' : ''}`}
                            onClick={() => setActiveNav('create')}
                        >
                            Create
                        </div>
                        <div 
                            className={`nav-item ${activeNav === 'stats' ? 'active' : ''}`}
                            onClick={() => setActiveNav('stats')}
                        >
                            Stats
                        </div>
                        <div
                            className={`nav-item ${activeNav === 'history' ? 'active' : ''}`}
                            onClick={() => setActiveNav('history')}
                        >
                            <span>History</span>
                        </div>
                        </div>
                    
                    {showModal && (
                        <div className="modal">
                            <div className="modal-content animate-in">
                                <div className="modal-icon">{modalContent.icon}</div>
                                <h2>{modalContent.title}</h2>
                                <p>{modalContent.message}</p>
                            </div>
                        </div>
                    )}

                    {showMenu && (
                        <div className="menu-overlay" onClick={() => setShowMenu(false)}>
                            <div className="menu-container" onClick={(e) => e.stopPropagation()}>
                                <div className="menu-header">
                                    <h2 style={{fontFamily: 'Bebas Neue', fontSize: '1.5rem', margin: 0}}>FIT FINESSE</h2>
                                    <button 
                                        className="menu-close-btn"
                                        onClick={() => setShowMenu(false)}
                                    >
                                        ‚úï
                                    </button>
                                </div>
                                
                                <div className="menu-content">
                                    <div className="menu-profile">
                                        <div style={{fontSize: '2rem', marginBottom: '0.5rem'}}>üë§</div>
                                        <div style={{fontWeight: '600', fontSize: '1.1rem'}}>{user?.name}</div>
                                        <div style={{color: 'var(--light-gray)', fontSize: '0.9rem'}}>{user?.email}</div>
                                        <div style={{color: 'var(--light-gray)', fontSize: '0.9rem'}}>{user?.phone}</div>
                                    </div>
                                    
                                    <div className="menu-divider"></div>
                                    
                                    <button className="menu-item" onClick={() => {
                                        setShowMenu(false);
                                        setActiveView('how-it-works');
                                    }}>
                                        <span>üìñ</span>
                                        <span>How It Works</span>
                                    </button>

                                    <button className="menu-item" onClick={() => {
                                        setShowMenu(false);
                                        setActiveView('faq');
                                    }}>
                                        <span>üí¨</span>
                                        <span>FAQ</span>
                                    </button>
                                    
                                    <button className="menu-item" onClick={() => window.location.href = 'mailto:support@fitfinesse.app'}>
                                        <span>üìß</span>
                                        <span>Contact Support</span>
                                    </button>
                                    
                                    <button className="menu-item" onClick={() => window.open('https://fitfinesse.app/terms', '_blank')}>
                                        <span>üìÑ</span>
                                        <span>Terms of Service</span>
                                    </button>
                                    
                                    <button className="menu-item" onClick={() => window.open('https://fitfinesse.app/privacy', '_blank')}>
                                        <span>üîí</span>
                                        <span>Privacy Policy</span>
                                    </button>
                                    
                                    <div className="menu-divider"></div>
                                    
                                    <button className="menu-item menu-logout" onClick={handleLogout}>
                                        <span>üö™</span>
                                        <span>Logout</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            ) : activeView === 'how-it-works' ? (
                <div className="content-page">
                    <div className="content-header">
                        <button className="back-btn" onClick={() => setActiveView('app')}>
                            ‚Üê Back
                        </button>
                        <h1 style={{fontFamily: 'Bebas Neue', fontSize: '2rem', margin: 0}}>HOW IT WORKS</h1>
                    </div>
                    <div className="content-body">
                        <div className="how-it-works-section">
                            <div className="step-number">1</div>
                            <h3>Create or Join a Pool</h3>
                            <p>Set your weekly gym goal (3-7 days) and stake real money ($5-$100). Invite friends or join existing pools.</p>
                        </div>
                        
                        <div className="how-it-works-section">
                            <div className="step-number">2</div>
                            <h3>Check In Daily</h3>
                            <p>Pools run Monday-Sunday. Check in from the gym once per day. Your location verifies you're actually there.</p>
                        </div>
                        
                        <div className="how-it-works-section">
                            <div className="step-number">3</div>
                            <h3>Win or Lose</h3>
                            <p>Hit your goal? You're a winner! Winners split the pot from those who didn't make it. Miss your goal? You forfeit your stake.</p>
                        </div>
                        
                        <div className="how-it-works-section">
                            <div className="step-number">4</div>
                            <h3>Get Paid</h3>
                            <p>Winnings are credited Monday morning after your pool completes. Winners take home their stake plus a share of the pot.</p>
                        </div>
                        
                        <div style={{
                            background: 'var(--dark-gray)',
                            padding: '1.5rem',
                            borderRadius: '12px',
                            marginTop: '2rem'
                        }}>
                            <h3 style={{color: 'var(--neon-green)', marginTop: 0}}>What if everyone wins?</h3>
                            <p style={{margin: 0}}>Everyone gets their full stake back with no fees. We only charge when there are losers.</p>
                        </div>
                        
                        <div style={{
                            background: 'var(--dark-gray)',
                            padding: '1.5rem',
                            borderRadius: '12px',
                            marginTop: '1rem'
                        }}>
                            <h3 style={{color: 'var(--electric-orange)', marginTop: 0}}>What if nobody wins?</h3>
                            <p style={{margin: 0}}>50% goes to charity, 50% covers operational costs.</p>
                        </div>
                    </div>
                </div>
            ) : activeView === 'faq' ? (
                <div className="content-page">
                    <div className="content-header">
                        <button className="back-btn" onClick={() => setActiveView('app')}>
                            ‚Üê Back
                        </button>
                        <h1 style={{fontFamily: 'Bebas Neue', fontSize: '2rem', margin: 0}}>FAQ</h1>
                    </div>
                    <div className="content-body">
                        <div className="faq-item">
                            <h3>How do check-ins work?</h3>
                            <p>Check in once per day from your gym. Your location is verified to ensure accountability. You can only check in once every 24 hours.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>When do pools start and end?</h3>
                            <p>All pools run Monday 12:01 AM to Sunday 11:59 PM Central Time. You have one week to hit your goal.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>How are payouts calculated?</h3>
                            <p>Winners split the losers' stakes. We take a 5% fee from forfeited money only. If everyone wins, everyone gets their full stake back with no fees.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>Can I cancel a pool?</h3>
                            <p>Only before the week starts (Monday 12:01 AM). Once the week begins, you're committed for accountability.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>Can I leave a pool mid-week?</h3>
                            <p>No. Pools lock once they start to ensure everyone is equally committed.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>How do I invite friends?</h3>
                            <p>Enter their email when creating a pool. They'll receive an invitation to accept or decline.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>What happens if I miss my goal?</h3>
                            <p>You forfeit your stake. Winners will split it (minus our 5% fee).</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>When do I get paid if I win?</h3>
                            <p>Winnings are credited to your account Monday morning after your pool completes.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>What's the maximum pool size?</h3>
                            <p>You can be in up to 5 active pools at once. Each pool can have unlimited members.</p>
                        </div>
                        
                        <div className="faq-item">
                            <h3>Is my payment information secure?</h3>
                            <p>Yes. All payments are processed through Stripe, an industry-leading payment processor. We never store your credit card information.</p>
                        </div>
                    </div>
                </div>
            ) : null}
        </>
    );
        }
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
